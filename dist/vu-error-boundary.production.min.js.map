{"version":3,"file":"vu-error-boundary.production.min.js","sources":["../src/index.ts"],"sourcesContent":["import {\n  ComponentPublicInstance,\n  defineComponent,\n  onErrorCaptured,\n  Ref,\n  ref,\n  renderSlot,\n  unref,\n  watchEffect,\n} from 'vue'\n\nexport const ErrorBoundary = defineComponent({\n  name: 'ErrorBoundary',\n  emits: {\n    reset: () => {\n      return true\n    },\n    error: (...args: [unknown, ComponentPublicInstance | null, string]) => {\n      if (args) return true\n    },\n  },\n  setup(_, { slots, emit }) {\n    // state\n    const error = ref<unknown>(null)\n\n    // methods\n    const resetErrorBoundary = () => {\n      emit('reset')\n      error.value = null\n    }\n\n    // hooks\n    onErrorCaptured((err, instance, info) => {\n      emit('error', err, instance, info)\n      error.value = err\n\n      return false\n    })\n\n    return () => {\n      if (unref(error)) {\n        return renderSlot(slots, 'fallback', {\n          resetErrorBoundary,\n          error: unref(error),\n        })\n      }\n\n      return slots.default?.()\n    }\n  },\n})\n\nexport function useErrorHandler(\n  givenError?: Ref<unknown>\n): (args: unknown) => void {\n  const error = ref<unknown>(null)\n\n  watchEffect(() => {\n    if (unref(givenError)) throw unref(givenError)\n    if (unref(error)) throw unref(error)\n  })\n\n  return args => {\n    error.value = args\n  }\n}\n"],"names":["ErrorBoundary","defineComponent","name","emits","reset","error","args","setup","_","slots","emit","ref","resetErrorBoundary","value","onErrorCaptured","err","instance","info","unref","renderSlot","givenError","watchEffect"],"mappings":"wRAWaA,EAAgBC,kBAAgB,CAC3CC,KAAM,gBACNC,MAAO,CACLC,MAAO,kBACE,GAETC,MAAO,sCAAIC,2BAAAA,qBACLA,EAAM,OAAO,IAGrBC,eAAMC,SAAKC,IAAAA,MAAOC,IAAAA,KAEVL,EAAQM,MAAa,MAGrBC,EAAqB,WACzBF,EAAK,SACLL,EAAMQ,MAAQ,aAIhBC,mBAAgB,SAACC,EAAKC,EAAUC,UAC9BP,EAAK,QAASK,EAAKC,EAAUC,GAC7BZ,EAAMQ,MAAQE,GAEP,KAGF,kBACDG,QAAMb,GACDc,aAAWV,EAAO,WAAY,CACnCG,mBAAAA,EACAP,MAAOa,QAAMb,WAIVI,iBAAAA,oDAKN,SACLW,OAEMf,EAAQM,MAAa,aAE3BU,eAAY,cACNH,QAAME,GAAa,MAAMF,QAAME,MAC/BF,QAAMb,GAAQ,MAAMa,QAAMb,MAGzB,SAAAC,GACLD,EAAMQ,MAAQP"}